<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css" type="text/css" >
    <link rel="stylesheet" href="/dist/styles/css/main.css">
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-aabb-collider-component/dist/aframe-aabb-collider-component.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v3.13.1/dist/aframe-extras.min.js"></script>
    <title>Cicilio Studio</title>
</head>
<body>
        
        <div id="scene">
            <a-scene shadow="shadowMapType: basic">

                <a-assets>
                    
                </a-assets>
                <!-- <a-sky color="#F6FAFB"></a-sky> -->
                <a-entity   light="type: ambient; intensity: 0.5;"></a-entity>
                <a-entity   light="type:directional; 
                                castShadow:true;
                                shadowCameraVisible: false;"
                            position="0 5 0"></a-entity>
                
                <a-box shadow="recieve: true" 
                    position="0 -1 0" 
                    width="100"
                    height="100"
                    depth="0.1"
                    rotation="90 0 0">
                    </a-box>

                    <a-box class="testBox" 
                    position="-0.5 1 -1sasa"
                    width="1"
                    height="1"
                    depth="1"
                    color="0x489372"
                    rotation="0 0 0">
                    </a-box>

                <a-entity vive-controls="hand: left">
                    <a-sphere class="sphere-controller" aabb-collider="objects: [preview-icon]" radius="0.03" color="blue" position="0 -0.01 -0.1"></a-sphere>
                    <a-entity class="testSelector" item-selector></a-entity>
                 </a-entity>
                 <a-entity vive-controls="hand: right">
                    <a-sphere class="sphere-controller" aabb-collider="objects: [preview-icon]" radius="0.03" color="blue" position="0 -0.01 -0.1"></a-sphere>
                </a-entity>
            </a-scene>

            <a-entity position="0 0 1">
                <a-entity id="camera" camera></a-entity>
            </a-entity>
 
    <script>
        // Mocking out react templates by adding array via setAttribute

        // Quick event listener test
        let sphereControllers = document.querySelectorAll('.sphere-controller');
        let els = Array.prototype.slice.call(sphereControllers);
        els.forEach((el) => {
            console.log('ELEMENT');
            console.log(el);
            el.addEventListener('hitstart', (e) => {
                //console.log("TESTing 123");
                e.target.setAttribute('material', 'color: #39ceef')
            });

            el.addEventListener('hitend', (e) => {
                //console.log("TESTing 123");
                e.target.setAttribute('material', 'color: #1d39d7')
            });
        })
        // end test

        let scene = document.querySelector('a-scene');
        
        if (scene.hasLoaded) {
            run();
        } else {
            scene.addEventListener('loaded', run);
        }

        function run() {
            // Dynamic assets test
            // <a-asset-item id="obj-asset-1" src="/assets/objects/senior_project/The_Brain.obj"></a-asset-item>
            // <a-asset-item id="mtl-asset-1" src="/assets/objects/senior_project/The_Brain.mtl"></a-asset-item>
            let objAsset1 = document.createElement('a-asset-item');
            objAsset1.setAttribute('id', 'obj-asset-1');
            objAsset1.setAttribute('src', '/assets/objects/senior_project/The_Brain.obj');

            let mtlAsset1 = document.createElement('a-asset-item');
            mtlAsset1.setAttribute('id', 'mtl-asset-1');
            mtlAsset1.setAttribute('src', '/assets/objects/senior_project/The_Brain.mtl');

            let assets = document.querySelector('a-assets');
            assets.appendChild(objAsset1);
            assets.appendChild(mtlAsset1);
            
            let assetList = [{
                    name: 'test',
                    obj: '#obj-asset-1',
                    mtl: '#mtl-asset-1',
                    previewImage: '/assets/objects/senior_project/bird.jpg'
                }, 
                {
                    name: 'test2'
                }
            ];
            let itemSelector = document.querySelector('a-entity[item-selector]');
            itemSelector.setAttribute('item-selector', 'assetList:' + JSON.stringify(assetList));
            console.log('ITEMSEL', itemSelector);
        }
        </script>

        <script defer src="/assets/icons/fontawesome-pro-5.0.8/svg-with-js/js/fontawesome-all.min.js"></script>
        <script src="/dist/js/main.js"></script>
    </body>
</html>